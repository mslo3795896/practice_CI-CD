var M=Object.defineProperty;var I=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var C=(a,t,d)=>t in a?M(a,t,{enumerable:!0,configurable:!0,writable:!0,value:d}):a[t]=d,h=(a,t)=>{for(var d in t||(t={}))q.call(t,d)&&C(a,d,t[d]);if(I)for(var d of I(t))S.call(t,d)&&C(a,d,t[d]);return a};var K=(a,t)=>{var d={};for(var n in a)q.call(a,n)&&t.indexOf(n)<0&&(d[n]=a[n]);if(a!=null&&I)for(var n of I(a))t.indexOf(n)<0&&S.call(a,n)&&(d[n]=a[n]);return d};import{_ as Y,b as O}from"./index-9ec1f801.js";import{Z as H,_ as Z,$ as z,B as G,r as L,D as J,a1 as Q,c as W,p as B,a0 as X,a2 as ee,m as k,U as te,j as _,o as x,k as ae,w as p,n as c,s as E,G as $,l as A,F as R,y as V}from"./vendor-c6516222.js";function se({api:a="",defaultValue:t={},disabledCheckout:d=!1,disableInitGetData:n=!1,afterGetData:g,beforeStoreData:D}){const o=H(),y=Z(),f=z();G("$scrollToElement");const s=L({defaultValue:t,params:{id:""},toolbar:{type:"edit"},formList:{}});J(()=>{}),Q(o.state.global.insidePage,()=>{const e=o.state.global.insidePage.status,u=o.state.global.insidePage.query?o.state.global.insidePage.query.id:"";e&&(s.params.id=u)}),L({forms:W(()=>[])});const i={getData:async()=>{const e=await o.dispatch("item/fetchItem",{api:a,id:s.params.id});s.defaultValue=h(h({},s.defaultValue),e),i.updateToolbar(e),g&&g(e)},validate:async({submit_data:e,btn_type:u})=>{let r=!1;for(const T in s.formList){const P=s.formList[T];if(!r)try{await P.validate()}catch(l){let b=l,{errorFields:j}=b,le=K(b,["errorFields"]);r=!0;const N=()=>{const w=m=>m.$parent.$.type.name==="RouterView"?!1:m.$parent.$.type.name==="Tabs"?m.$parent:w(m.$parent),v=m=>m.$parent.$.type.name==="RouterView"?!1:m.$parent.$.type.name==="ATabPane"?m.$parent.$.vnode.key:v(m.$parent),F=w(P);if(F){const m=v(P);F&&F.setActiveKey(m)}},U=()=>{const v=P.$el.querySelector(".ant-form-item-has-error").querySelector("input, select, textarea");v&&(v.focus(),v.className.includes("ant-calendar-picker-input")&&v.click())};N(),ee(()=>{P.scrollToField(j[0].name,{block:"center",behavior:"smooth"}),setTimeout(()=>{U()},300)})}}r||(D&&D(),i.submit({submit_data:s.defaultValue,btn_type:u}))},submit:async({submit_data:e,btn_type:u})=>{let r=Object.assign({},e);const l=o.state.global.insidePage.status;s.params.id&&(r.id=s.params.id),l&&(r.brands=[{id:+f.query.id}]);const b=await o.dispatch("item/store",{api:a,submitData:r});g&&g(b),i.updateToolbar(b),i.onSubmitFinish({msg:"\u9805\u76EE\u66F4\u65B0\u6210\u529F",btn_type:u,query:{id:b?b.id:e.id}})},onSubmitFinish:({msg:e,btn_type:u,query:r})=>{const{status:l,pageGroupId:b=void 0,pageId:T=void 0}=o.state.global.insidePage;switch(k.success(e),u){case"save":l?o.dispatch("global/setInsidePage",{status:"edit",query:r,pageGroupId:b,pageId:T}):y.push({path:f.path,query:r});break;case"savenadd":r.id&&i.checkout(r.id),l?o.dispatch("global/setInsidePage",{status:"add",pageGroupId:b,pageId:T}):(y.push({path:f.path}),y.go(0));break;case"savenclose":i.onCancel(r.id);break}},onCancel:async(e="")=>{const{status:u,pageGroupId:r=void 0,pageId:l=void 0}=o.state.global.insidePage;e&&!d&&await i.checkout(e),u?o.dispatch("global/setInsidePage",{status:"list",pageGroupId:r,pageId:l}):y.push({path:f.path.replace("/edit",""),query:f.query.from})},checkout:async e=>{await o.dispatch("item/checkout",{api:a,ids:[e]})},trash:async e=>{await i.updateState(e,-2),k.success("\u56DE\u6536\u6210\u529F")},restore:async e=>{await i.updateState(e,1),k.success("\u6062\u5FA9\u6210\u529F")},updateState:async(e,u)=>{await o.dispatch("item/updateState",{api:a,ids:[e],state:u}),i.getData()},delete:async e=>{await o.dispatch("item/remove",{api:a,ids:[e]}),k.success("\u522A\u9664\u6210\u529F"),i.onCancel()},updateToolbar:e=>{!e||(["trash-edit","edit"].includes(s.toolbar.type)&&(s.toolbar.type=e.state===-2?"trash-edit":"edit"),i.initToolbar(s.toolbar))},updateParams:()=>{const e=()=>{if(o.state.global.insidePage.status){const r=o.state.global.insidePage.query?o.state.global.insidePage.query.id:"";return Number(r)||""}else return Number(f.query.id)||""};s.params.id=e(),["edit","add"].includes(s.toolbar.type)&&(s.toolbar.type=s.params.id?"edit":"add")},initData:()=>{i.updateParams(),s.params.id&&!n&&i.getData()},addForm:(e,u)=>{s.formList[u]=e},deleteForm:e=>{delete s.formList[e]}};return i.initData(),B("addForm",i.addForm),B("deleteForm",i.deleteForm),h(h({},X(s)),i)}const ie={setup(a){const t=L({text:"",title:"",date:""}),d=se({api:"brand",defaultValue:t});return h({submitData:t},d)},components:{Layout:te(()=>O(()=>import("./main-61010287.js"),["cms-build/js/main-61010287.js","cms-build/css/main-d00d35ab.css","cms-build/js/index-9ec1f801.js","cms-build/css/index-fdcc14a8.css","cms-build/js/vendor-c6516222.js"]))},data(){return{activeKey:"1"}},computed:{}},ne=V("EDIT "),oe=V("SUBMIT"),de=V("Content of Tab Pane 3");function re(a,t,d,n,g,D){const o=_("a-button"),y=_("a-input"),f=_("a-form-item"),s=_("a-date-picker"),i=_("BaseForm"),e=_("a-tab-pane"),u=_("a-tabs"),r=_("Layout");return x(),ae(r,null,{default:p(()=>[ne,c(o,{onClick:a.validate},{default:p(()=>[oe]),_:1},8,["onClick"]),(x(),E(R,null,$(50,l=>A("div",null,"...")),64)),c(u,{activeKey:g.activeKey,"onUpdate:activeKey":t[3]||(t[3]=l=>g.activeKey=l)},{default:p(()=>[c(e,{key:"1",tab:"Tab 1"},{default:p(()=>[c(i,{model:n.submitData},{default:p(()=>[c(f,{label:"Activity name",name:"text",required:""},{default:p(()=>[c(y,{value:n.submitData.text,"onUpdate:value":t[0]||(t[0]=l=>n.submitData.text=l)},null,8,["value"])]),_:1}),c(f,{label:"Date",name:"date",required:""},{default:p(()=>[c(s,{value:n.submitData.date,"onUpdate:value":t[1]||(t[1]=l=>n.submitData.date=l),valueFormat:"YYYY-MM-DD"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),c(e,{key:"2",tab:"Tab 2",forceRender:""},{default:p(()=>[c(i,{model:n.submitData},{default:p(()=>[c(f,{label:"title",name:"title",required:""},{default:p(()=>[c(y,{value:n.submitData.title,"onUpdate:value":t[2]||(t[2]=l=>n.submitData.title=l)},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),c(e,{key:"3",tab:"Tab 3"},{default:p(()=>[de]),_:1})]),_:1},8,["activeKey"]),(x(),E(R,null,$(50,l=>A("div",null,"...")),64))]),_:1})}var pe=Y(ie,[["render",re]]);export{pe as default};
//# sourceMappingURL=edit-f6eb296a.js.map
